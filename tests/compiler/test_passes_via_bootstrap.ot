// Test compiler passes functionality using the bootstrap compiler
// The bootstrap compiler is auto-loaded for files in tests/
// This tests that the CONCEPTS work, using bootstrap compiler functions

console.log("=== Testing Compiler Passes Concepts ===");
console.log("Using bootstrap compiler infrastructure");

// ============================================================================
// Test 1: Tokenization works
// ============================================================================

console.log("\n--- Test 1: Tokenization ---");
console.log("Source: let x = 1 + 2;");
let tokens1 = tokenize("let x = 1 + 2;");
console.log("  Tokens: " + tokens1.length);
console.log("  SUCCESS");

// ============================================================================
// Test 2: Parsing works
// ============================================================================

console.log("\n--- Test 2: Parsing ---");
console.log("Source: function add(a, b) { return a + b; }");
let ast2 = parseSource("function add(a, b) { return a + b; }");
console.log("  Statements: " + ast2.body.length);
console.log("  SUCCESS");

// ============================================================================
// Test 3: Full pipeline (bootstrap version)
// ============================================================================

console.log("\n--- Test 3: Full Pipeline (Bootstrap) ---");
console.log("Source: let x = 42;");
let result3 = compileToBytecode("let x = 42;");
console.log("  Bytecode: " + result3.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Test 4: Function compilation
// ============================================================================

console.log("\n--- Test 4: Function Compilation ---");
console.log("Source: function square(n) { return n * n; }");
let result4 = compileToBytecode("function square(n) { return n * n; }");
console.log("  Bytecode: " + result4.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Test 5: Complex expressions
// ============================================================================

console.log("\n--- Test 5: Complex Expressions ---");
console.log("Source: let result = (1 + 2) * 3 - 4 / 2;");
let result5 = compileToBytecode("let result = (1 + 2) * 3 - 4 / 2;");
console.log("  Bytecode: " + result5.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Test 6: Control flow
// ============================================================================

console.log("\n--- Test 6: Control Flow ---");
console.log("Source: if (x > 0) { y = 1; } else { y = 0; }");
let result6 = compileToBytecode("let x = 5; let y; if (x > 0) { y = 1; } else { y = 0; }");
console.log("  Bytecode: " + result6.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Test 7: Loops
// ============================================================================

console.log("\n--- Test 7: Loops ---");
console.log("Source: while (i < 10) { i = i + 1; }");
let result7 = compileToBytecode("let i = 0; while (i < 10) { i = i + 1; }");
console.log("  Bytecode: " + result7.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Test 8: TypeScript syntax
// ============================================================================

console.log("\n--- Test 8: TypeScript Syntax ---");
console.log("Source: let x: number = 42;");
let result8 = compileToBytecode("let x: number = 42;");
console.log("  Bytecode: " + result8.length + " bytes");
console.log("  SUCCESS");

// ============================================================================
// Summary
// ============================================================================

console.log("\n=== All Tests Complete ===");
console.log("Bootstrap compiler passes functional for:");
console.log("  - Tokenization");
console.log("  - Parsing");
console.log("  - Bytecode generation");
console.log("  - Functions, expressions, control flow, loops");
console.log("  - TypeScript syntax support");
